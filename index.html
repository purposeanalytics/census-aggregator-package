<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>What the Package Does (One Line, Title Case) • censusaggregate</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="What the Package Does (One Line, Title Case)">
<meta property="og:description" content="What the package does (one paragraph).">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">censusaggregate</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="censusaggregate">censusaggregate<a class="anchor" aria-label="anchor" href="#censusaggregate"></a>
</h1></div>
<p>The goal of censusaggregate is to easily retrieve and aggregate Canadian census vectors, and their breakdowns, across multiple (shared) geographies.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install censusaggregate from GitHub:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"purposeanalytics/census-aggregator-package"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="api-key-and-caching">API key and caching<a class="anchor" aria-label="anchor" href="#api-key-and-caching"></a>
</h2>
<p>censusaggregate uses the <a href="https://github.com/mountainMath/cancensus" class="external-link"><code>cancensus</code></a> package and <a href="https://censusmapper.ca/" class="external-link">CensusMapper API</a>. As per their documentation:</p>
<blockquote>
<p>You can obtain a free API key by <a href="https://censusmapper.ca/users/sign_up" class="external-link">signing up</a> for a CensusMapper account. To check your API key, just go to “Edit Profile” (in the top-right of the CensusMapper menu bar). Once you have your key, you can store it in your system environment so it is automatically used in API calls. To do so just enter cancensus::set_api_key(<your_api_key>, install = TRUE).</your_api_key></p>
<p>CensusMapper API keys are free and public API quotas are generous; however, due to incremental costs of serving large quantities of data, there are some limits to API usage in place. For most use cases, these API limits should not be an issue. Production uses with large extracts of detailed geographies may run into API quota limits.</p>
</blockquote>
<p>In addition, censusaggregate uses <code>cancensus</code>’ caching infrastructure to avoid repeat calls to the API:</p>
<blockquote><p>By default, cancensus caches in R’s temporary directory, but this cache is not persistent across sessions. In order to speed up performance, reduce quota usage, and reduce the need for unnecessary network calls, we recommend assigning a persistent local cache using cancensus::set_cache_path(<local cache path>, install = TRUE), this enables more efficient loading and reuse of downloaded data. Users will be prompted with a suggestion to change their default cache location when making API calls if one has not been set yet.</local></p></blockquote>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>censusaggregate has two primary functions, the first of which is to retrieve a census vector and <em>all</em> of its child vectors (children). Child vectors further break down or provide additional detail to a vector. For example, if we want to get the vector that describes the structural type of dwellings, first we list all vectors for the 2016 census, then filter for the one of interest:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mountainMath/cancensus" class="external-link">cancensus</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purposeanalytics.github.io/census-aggregator-package">censusaggregate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span></span>
<span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="st">"CA16"</span></span>
<span></span>
<span><span class="va">vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mountainmath.github.io/cancensus/index.html/reference/list_census_vectors.html" class="external-link">list_census_vectors</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">label</span> <span class="op">==</span> <span class="st">"Occupied private dwellings by structural type of dwelling data"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vector</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 7</span></span>
<span><span class="co">#&gt;   vector     type  label         units parent_vector aggregation details        </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;fct&gt; &lt;chr&gt;         &lt;fct&gt; &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;          </span></span>
<span><span class="co">#&gt; 1 v_CA16_408 Total Occupied pri… Numb… &lt;NA&gt;          Additive    CA 2016 Census…</span></span></code></pre></div>
<p>Next we can retrieve the vector using its code (v_CA16_408) and its children, for a given set of regions and at a given level. Here, we retrieve data for three Census subdivisions (CSD), then look at the data, which includes information like the highest parent vector, a description of the vector, the units its in, its direct parent (since children can be nested), the geographic identifier of the CSD, the population and number of households in that CSD, and the data value itself.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vector</span> <span class="op">&lt;-</span> <span class="va">vector</span><span class="op">[[</span><span class="st">"vector"</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="va">vector_with_breakdowns</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_census_vectors_and_children.html">get_census_vectors_and_children</a></span><span class="op">(</span></span>
<span>  <span class="va">dataset</span>,</span>
<span>  regions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>CSD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"3520005"</span>, <span class="st">"3521005"</span>, <span class="st">"3521010"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  level <span class="op">=</span> <span class="st">"CSD"</span>,</span>
<span>  vectors <span class="op">=</span> <span class="va">vector</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">vector_with_breakdowns</span></span>
<span><span class="co">#&gt; # A tibble: 30 × 13</span></span>
<span><span class="co">#&gt;    highest_parent_vector vector     type  label  units parent_vector aggregation</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;                 &lt;chr&gt;      &lt;fct&gt; &lt;chr&gt;  &lt;fct&gt; &lt;chr&gt;         &lt;chr&gt;      </span></span>
<span><span class="co">#&gt;  1 v_CA16_408            v_CA16_408 Total Occup… Numb… &lt;NA&gt;          Additive   </span></span>
<span><span class="co">#&gt;  2 v_CA16_408            v_CA16_408 Total Occup… Numb… &lt;NA&gt;          Additive   </span></span>
<span><span class="co">#&gt;  3 v_CA16_408            v_CA16_408 Total Occup… Numb… &lt;NA&gt;          Additive   </span></span>
<span><span class="co">#&gt;  4 v_CA16_408            v_CA16_409 Total Singl… Numb… v_CA16_408    Additive   </span></span>
<span><span class="co">#&gt;  5 v_CA16_408            v_CA16_409 Total Singl… Numb… v_CA16_408    Additive   </span></span>
<span><span class="co">#&gt;  6 v_CA16_408            v_CA16_409 Total Singl… Numb… v_CA16_408    Additive   </span></span>
<span><span class="co">#&gt;  7 v_CA16_408            v_CA16_410 Total Apart… Numb… v_CA16_408    Additive   </span></span>
<span><span class="co">#&gt;  8 v_CA16_408            v_CA16_410 Total Apart… Numb… v_CA16_408    Additive   </span></span>
<span><span class="co">#&gt;  9 v_CA16_408            v_CA16_410 Total Apart… Numb… v_CA16_408    Additive   </span></span>
<span><span class="co">#&gt; 10 v_CA16_408            v_CA16_411 Total Other… Numb… v_CA16_408    Additive   </span></span>
<span><span class="co">#&gt; # … with 20 more rows, and 6 more variables: aggregation_type &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   details &lt;chr&gt;, geo_uid &lt;chr&gt;, population &lt;dbl&gt;, households &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   value &lt;dbl&gt;</span></span></code></pre></div>
<p>We can see that there are 10 vectors returned - 9 breakdowns and the original parent vector - each of which with 3 records, one for each of the CSDs we requested data for.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vector_with_breakdowns</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">vector</span>, <span class="va">parent_vector</span>, <span class="va">label</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 10 × 4</span></span>
<span><span class="co">#&gt;    vector     parent_vector label                                              n</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;      &lt;chr&gt;         &lt;chr&gt;                                          &lt;int&gt;</span></span>
<span><span class="co">#&gt;  1 v_CA16_408 &lt;NA&gt;          Occupied private dwellings by structural type…     3</span></span>
<span><span class="co">#&gt;  2 v_CA16_409 v_CA16_408    Single-detached house                              3</span></span>
<span><span class="co">#&gt;  3 v_CA16_410 v_CA16_408    Apartment in a building that has five or more…     3</span></span>
<span><span class="co">#&gt;  4 v_CA16_411 v_CA16_408    Other attached dwelling                            3</span></span>
<span><span class="co">#&gt;  5 v_CA16_412 v_CA16_411    Semi-detached house                                3</span></span>
<span><span class="co">#&gt;  6 v_CA16_413 v_CA16_411    Row house                                          3</span></span>
<span><span class="co">#&gt;  7 v_CA16_414 v_CA16_411    Apartment or flat in a duplex                      3</span></span>
<span><span class="co">#&gt;  8 v_CA16_415 v_CA16_411    Apartment in a building that has fewer than f…     3</span></span>
<span><span class="co">#&gt;  9 v_CA16_416 v_CA16_411    Other single-attached house                        3</span></span>
<span><span class="co">#&gt; 10 v_CA16_417 v_CA16_408    Movable dwelling                                   3</span></span></code></pre></div>
<p>And we can quickly look at the values themselves:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vector_with_breakdowns</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">vector</span>, <span class="va">label</span>, <span class="va">geo_uid</span>, <span class="va">value</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 30 × 4</span></span>
<span><span class="co">#&gt;    vector     label                                               geo_uid  value</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;      &lt;chr&gt;                                               &lt;chr&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 v_CA16_408 Occupied private dwellings by structural type of d… 3520005 1.11e6</span></span>
<span><span class="co">#&gt;  2 v_CA16_408 Occupied private dwellings by structural type of d… 3521005 2.41e5</span></span>
<span><span class="co">#&gt;  3 v_CA16_408 Occupied private dwellings by structural type of d… 3521010 1.68e5</span></span>
<span><span class="co">#&gt;  4 v_CA16_409 Single-detached house                               3520005 2.70e5</span></span>
<span><span class="co">#&gt;  5 v_CA16_409 Single-detached house                               3521005 9.08e4</span></span>
<span><span class="co">#&gt;  6 v_CA16_409 Single-detached house                               3521010 8.76e4</span></span>
<span><span class="co">#&gt;  7 v_CA16_410 Apartment in a building that has five or more stor… 3520005 4.93e5</span></span>
<span><span class="co">#&gt;  8 v_CA16_410 Apartment in a building that has five or more stor… 3521005 6.31e4</span></span>
<span><span class="co">#&gt;  9 v_CA16_410 Apartment in a building that has five or more stor… 3521010 1.75e4</span></span>
<span><span class="co">#&gt; 10 v_CA16_411 Other attached dwelling                             3520005 3.50e5</span></span>
<span><span class="co">#&gt; # … with 20 more rows</span></span></code></pre></div>
<p>The second function of censusaggregate is to aggregate the census vectors across multiple geographies. In this case, we want to aggregate each variable so that there is only one record for each, combining the values across the three CSDs. To do this, we use <code>aggregate_census_vectors</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vector_with_breakdowns</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/aggregate_census_vectors.html">aggregate_census_vectors</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">vector</span>, <span class="va">label</span>, <span class="va">value</span>, <span class="va">value_proportion</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 10 × 4</span></span>
<span><span class="co">#&gt;    vector     label                                       value value_proportion</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;      &lt;chr&gt;                                       &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 v_CA16_408 Occupied private dwellings by structural … 1.52e6         1       </span></span>
<span><span class="co">#&gt;  2 v_CA16_409 Single-detached house                      4.48e5         0.294   </span></span>
<span><span class="co">#&gt;  3 v_CA16_410 Apartment in a building that has five or … 5.74e5         0.377   </span></span>
<span><span class="co">#&gt;  4 v_CA16_411 Other attached dwelling                    4.99e5         0.328   </span></span>
<span><span class="co">#&gt;  5 v_CA16_412 Semi-detached house                        1.21e5         0.0795  </span></span>
<span><span class="co">#&gt;  6 v_CA16_413 Row house                                  1.16e5         0.0765  </span></span>
<span><span class="co">#&gt;  7 v_CA16_414 Apartment or flat in a duplex              6.79e4         0.0446  </span></span>
<span><span class="co">#&gt;  8 v_CA16_415 Apartment in a building that has fewer th… 1.91e5         0.126   </span></span>
<span><span class="co">#&gt;  9 v_CA16_416 Other single-attached house                2.96e3         0.00195 </span></span>
<span><span class="co">#&gt; 10 v_CA16_417 Movable dwelling                           4.55e2         0.000299</span></span></code></pre></div>
<p>In this case, it returns a field <code>value</code> which is the sum of the values within the three CSDs, and <code>value_proportion</code>, which breaks down the value of the highest parent vector (v_CA16_408). For example, there are 448,000 households in total a Single-detached house in the queried CSDs, which represents 29.4% of all households in those CSDs.</p>
</div>
<div class="section level2">
<h2 id="supported-vector-aggregation">Supported vector aggregation<a class="anchor" aria-label="anchor" href="#supported-vector-aggregation"></a>
</h2>
<p>The vector aggregation happens automatically, based on the vectors’ units and aggregation type:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vectors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mountainmath.github.io/cancensus/index.html/reference/list_census_vectors.html" class="external-link">list_census_vectors</a></span><span class="op">(</span><span class="st">"CA16"</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/derive_aggregation_type.html">derive_aggregation_type</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vectors</span>  <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">units</span>, <span class="va">aggregation_type</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 3</span></span>
<span><span class="co">#&gt;   units              aggregation_type     n</span></span>
<span><span class="co">#&gt;   &lt;fct&gt;              &lt;chr&gt;            &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 Number             Additive          6448</span></span>
<span><span class="co">#&gt; 2 Number             Average              1</span></span>
<span><span class="co">#&gt; 3 Currency           Average             41</span></span>
<span><span class="co">#&gt; 4 Currency           Median              41</span></span>
<span><span class="co">#&gt; 5 Ratio              Average             13</span></span>
<span><span class="co">#&gt; 6 Percentage (0-100) Average             79</span></span></code></pre></div>
<p>In the previous example, we worked with vectors with <code>units = "Number"</code> and <code>aggregation_type = "Additive"</code>, which is one of the three supported aggregations:</p>
<ol style="list-style-type: decimal">
<li>Units: Number, Aggregation Type: Additive</li>
<li>Units: Percentage (0-100), Aggregation Type: Average</li>
<li>Units: Currency, Aggregation Type: Average</li>
</ol>
<div class="section level3">
<h3 id="units-number-aggregation-type-additive">Units: Number, Aggregation Type: Additive<a class="anchor" aria-label="anchor" href="#units-number-aggregation-type-additive"></a>
</h3>
<p>The <code>value</code> is derived by summing all of the <code>value</code> for each vector, across geographies. The result is a count (e.g. population, households). An additional field, <code>value_proportion</code>, is derived, describing what proportion of the total count (e.g. of population, households) from the highest parent vector falls within each child vector.</p>
</div>
<div class="section level3"><h3 id="units-percentage-0-100-aggregation-type-average">Units: Percentage (0-100), Aggregation Type: Average<a class="anchor" aria-label="anchor" href="#units-percentage-0-100-aggregation-type-average"></a>
</h3></div>
<div class="section level3"><h3 id="units-currency-aggregation-type-average">Units: Currency, Aggregation Type: Average<a class="anchor" aria-label="anchor" href="#units-currency-aggregation-type-average"></a>
</h3></div>
<div class="section level3">
<h3 id="special-cases">Special cases<a class="anchor" aria-label="anchor" href="#special-cases"></a>
</h3>
<div class="section level4"><h4 id="aggregate_population_change">aggregate_population_change()<a class="anchor" aria-label="anchor" href="#aggregate_population_change"></a>
</h4></div>
<div class="section level4"><h4 id="aggregate_population_density">aggregate_population_density()<a class="anchor" aria-label="anchor" href="#aggregate_population_density"></a>
</h4></div>
</div>
<div class="section level3">
<h3 id="unsupported-aggregations">Unsupported aggregations<a class="anchor" aria-label="anchor" href="#unsupported-aggregations"></a>
</h3>
<p>The following are not supported:</p>
<ol style="list-style-type: decimal">
<li>Units: Number, Aggregation Type: Average</li>
<li>Units: Currency, Aggregation Type: Median</li>
<li>Units: Ratio, Aggregation Type: Average</li>
</ol>
<p>If you try to aggregate this data, a message and empty tibble will be returned:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">median_vector</span> <span class="op">&lt;-</span> <span class="va">vectors</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">units</span> <span class="op">==</span> <span class="st">"Currency"</span>, <span class="va">aggregation_type</span> <span class="op">==</span> <span class="st">"Median"</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">vector</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/get_census_vectors_and_children.html">get_census_vectors_and_children</a></span><span class="op">(</span></span>
<span>  <span class="va">dataset</span>,</span>
<span>  regions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>CSD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"3520005"</span>, <span class="st">"3521005"</span>, <span class="st">"3521010"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  level <span class="op">=</span> <span class="st">"CSD"</span>,</span>
<span>  vectors <span class="op">=</span> <span class="va">median_vector</span></span>
<span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/aggregate_census_vectors.html">aggregate_census_vectors</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Aggregation for vectors with `units: Currency` and `aggregation_type:</span></span>
<span><span class="co">#&gt; Median` is not available. Vectors with this combination have been dropped:</span></span>
<span><span class="co">#&gt; v_CA16_2207.</span></span>
<span><span class="co">#&gt; # A tibble: 0 × 0</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="related-work">Related work<a class="anchor" aria-label="anchor" href="#related-work"></a>
</h2>
<p>censusaggregate heavily relies on existing work from <a href=""><code>cancensus</code></a> (and the related <a href="">CensusMapper</a>) to fetch census data. It has some similar functionality to the <a href=""><code>tongfen</code></a> package, but is not as feature rich - rather, it focuses on exclusively getting and aggregating Canadian census vectors across multiple (shared) geographies (in contrast to <code>tongfen</code>, which …)</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing censusaggregate</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>First Last <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/YOUR-ORCID-ID" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
